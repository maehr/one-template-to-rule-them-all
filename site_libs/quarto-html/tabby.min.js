(function(o,l){typeof define=="function"&&define.amd?define([],function(){return l(o)}):typeof exports=="object"?module.exports=l(o):o.Tabby=l(o)})(typeof global<"u"?global:typeof window<"u"?window:this,function(o){"use strict";var l={idPrefix:"tabby-toggle_",default:"[data-tabby-default]"},A=function(){var e={};return Array.prototype.forEach.call(arguments,function(r){for(var t in r){if(!r.hasOwnProperty(t))return;e[t]=r[t]}}),e},p=function(e,r){var t;typeof o.CustomEvent=="function"?t=new CustomEvent("tabby",{bubbles:!0,cancelable:!0,detail:r}):(t=document.createEvent("CustomEvent"),t.initCustomEvent("tabby",!0,!0,r)),e.dispatchEvent(t)},v=function(e){d(e.target)},h=function(e){return[...e.querySelectorAll('a[href], button, input, textarea, select, details,[tabindex]:not([tabindex="-1"])')].filter(r=>!r.hasAttribute("disabled")&&!r.getAttribute("aria-hidden"))},y=function(e,r,t){e.id.slice(0,t.idPrefix.length)===t.idPrefix&&(e.id=""),e.removeEventListener("focus",v,!0),e.removeAttribute("role"),e.removeAttribute("aria-controls"),e.removeAttribute("aria-selected"),e.removeAttribute("tabindex"),e.closest("li").removeAttribute("role"),r.removeAttribute("role"),r.removeAttribute("aria-labelledby"),r.removeAttribute("hidden")},x=function(e,r,t){e.id||(e.id=t.idPrefix+r.id),e.setAttribute("role","tab"),e.setAttribute("aria-controls",r.id),e.closest("li").setAttribute("role","presentation"),r.setAttribute("role","tabpanel"),r.setAttribute("aria-labelledby",e.id),e.matches(t.default)?e.setAttribute("aria-selected","true"):(e.setAttribute("aria-selected","false"),r.setAttribute("hidden","hidden")),e.addEventListener("focus",v)},E=function(e){var r=e.closest('[role="tablist"]');if(!r)return{};var t=r.querySelector('[role="tab"][aria-selected="true"]');if(!t)return{};var a=document.querySelector(t.hash);return t.setAttribute("aria-selected","false"),a?(a.setAttribute("hidden","hidden"),{previousTab:t,previousContent:a}):{previousTab:t}},g=function(e,r){e.setAttribute("aria-selected","true"),r.removeAttribute("hidden"),e.focus()},d=function(e){if(!(!e||e.getAttribute("aria-selected")=="true")){var r=document.querySelector(e.hash);if(r){var t=E(e);g(e,r),t.tab=e,t.content=r,p(e,t)}}},w=function(e){var r=e.closest('[role="tablist"]'),t=r?r.querySelectorAll('[role="tab"]'):null;if(t)return{tabs:t,index:Array.prototype.indexOf.call(t,e)}},q=function(e,r){var t=w(e);if(t){var a=t.tabs.length-1,n;["ArrowUp","ArrowLeft","Up","Left"].indexOf(r)>-1?n=t.index<1?a:t.index-1:["ArrowDown","ArrowRight","Down","Right"].indexOf(r)>-1?n=t.index===a?0:t.index+1:r==="Home"?n=0:r==="End"&&(n=a),d(t.tabs[n])}},S=function(e,r){var t={},a,n;t.destroy=function(){var u=n.querySelectorAll("a");Array.prototype.forEach.call(u,function(i){var s=document.querySelector(i.hash);s&&y(i,s,a)}),n.removeAttribute("role"),document.documentElement.removeEventListener("click",b,!0),n.removeEventListener("keydown",m,!0),a=null,n=null},t.setup=function(){if(n=document.querySelector(e),!!n){var u=n.querySelectorAll("a");n.setAttribute("role","tablist");var i=o.document.body.classList.contains("reveal-viewport"),s=1;Array.prototype.forEach.call(u,function(c){i?c.setAttribute("tabindex",""+s++):c.setAttribute("tabindex","0");var f=document.querySelector(c.hash);f&&(i&&h(f).forEach(function(T){T.setAttribute("tabindex",""+s++)}),x(c,f,a))})}},t.toggle=function(u){var i=u;typeof u=="string"&&(i=document.querySelector(e+' [role="tab"][href*="'+u+'"]')),d(i)};var b=function(u){var i=u.target.closest(e+' [role="tab"]');i&&(u.preventDefault(),d(i))},m=function(u){var i=document.activeElement;i.matches(e+' [role="tab"]')&&(["Home","End"].indexOf(u.key)<0||q(i,u.key))},L=function(){a=A(l,r||{}),t.setup(),document.documentElement.addEventListener("click",b,!0),n.addEventListener("keydown",m,!0)};return L(),t};return S});
